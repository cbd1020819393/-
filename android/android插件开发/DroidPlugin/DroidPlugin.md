# Android插件化原理解析——Hook机制之动态代理

## 代理是什么
代理通俗理解就是帮我们做想做的事情。就像平常租房子要找中介，买国外的东西要找代购。
代理可以实现方法增强，如常用的日志，缓存等；也可以实现方法拦截，托管代理方法修改原方法的参数和返回值。

## 静态代理
传统的静态代理模式需要为每一个需要代理的类写一个代理类，去实现本身代码想要的功能。

## 动态代理
JDK提供了动态代理方式，可以简单理解为JVM可以在运行时帮我们动态生成一系列的代理类，这样我们就不需要手写每一个静态的代理类了。

## 代理Hook
如果我们自己创建代理对象，然后把原始对象替换为我们的代理对象，那么就可以在这个代理对象为所欲为了；修改参数，替换返回值，我们称之为Hook。

1. 寻找Hook点，原则是静态变量或者单例对象，尽量Hook pulic的对象和方法，非public不保证每个版本都一样，需要适配。
2. 选择合适的代理方式，如果是接口可以用动态代理；如果是类可以手动写代理也可以使用cglib。
3. 偷梁换柱——用代理对象替换原始对象